#!/usr/bin/env sh

# Must have at least two services.
if [ $# -lt 3 ]; then
  printf 'Usage: %s \e[4mtarget\e[0m \e[4mchild\e[0m [, \e[4mchild\e[0m...]\n' "$0"
  exit 1
fi

target="$1"
shift

while [ $# -gt 0 ]; do
  service="$1"
  service_dir="/etc/s6-overlay/s6-rc.d/$service"

  if [ -d "$service_dir/dependencies.d" ]; then
    mkdir "$service_dir/dependencies.d"
  fi

  touch "$service_dir/dependencies.d/$target"
  shift
done